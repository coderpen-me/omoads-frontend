{% load staticfiles %}
<!DOCTYPE html>
<html lang="en" style="overflow-x:hidden">
<head>
  <title>OmoAds</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-105587377-1', 'auto');
    ga('send', 'pageview');

  </script>

  

  <style type="text/css">
    html,body{
      height: 100%;
      margin: 0px;
      /*overflow-y: ;*/
      background-color: #f2f2f2;
    }
    .navbar{
      background-color: #1c1c1c;
    }
    .navigationBar{
      margin: 0px;
      border-radius: 0px;
      border-width: 0px;
      /*height: ;*/
    }
    .shadow{
      box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.2), 0 3px 10px 0 rgba(0, 0, 0, 0.19);
    }
    .cart-display{
      padding-top: 15px;
    }
    .cont{
      /*height: 400px;*/
      background-color: #fff;
      padding-bottom: 10px;
    }
    .content-header{
      padding: 12px;
      padding-left: 20px;
      font-size: 17px; 
      color: #666;
      border-bottom: 1px solid #dbdbdb;
    }
    .line{
      height: 1px;
      background-color: #c1c1c1;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    .cart-item .row{
      margin: 0px;
      margin-top: 20px;
      margin-bottom: 10px; 
      padding-right: 10px;
    }
    .cart-item p{
      margin-bottom: 0px;
      color: #737373; 
    }
    .cart-item .row h4{
      margin-top: 5px;
    }
    .cart-item h3{
      margin-top: 10px;
    }
    .priceDetails{
      padding: 10px 20px;
    }
    .priceDetails p{
      font-size: 17px;
      font-weight: 500;
      padding-top: 15px;
      padding-bottom: 15px;
      margin-bottom: 0px; 
    }
    .priceDetails .finalPrice{
      color: #ff6c00;
      font-size: 25px;
      font-weight: 600;
      padding-top: 10px;
    }
    .edit-button{
      /*margin-top: 15px;*/
      font-size: 17px;
      padding-left: 15px;
      color: #545454;
    }
    .edit-button:hover{
      color: #337ab7;
    }
    .remove-button{
      /*margin-top: 15px;*/
      font-size: 17px;
      padding-left: 15px;
      color: #545454;
    }
    .remove-button:hover{
      color: #f70000;
    }
    @keyframes fadeout {
    0%{opacity:0;top:50%}
    20%{opacity:1;}
    80%{opacity:1;top:50%;}
    100%{opacity:0;
      top:-50%;
    }

    }
    #message {
      position: absolute;
      z-index: 9999;
      top: -50%;
      left: 25%;
      right: 25%;
      background: #fde073;
      text-align: center;
      animation-name: fadeout;
      animation-duration: 2s;
      overflow: hidden;
      opacity:0;
      box-shadow: 0 0 5px black;
    }

    .modal-header{
      padding-top: 20px;
      padding-bottom: 20px;
      background-color: #f3f3f3;
      border-radius: 10px 10px 0px 0px;

    }
    .modal-header p{
      margin-bottom: 0px;
      color: #575757;
    }
    .modal-title{
      color: #575757;
    }
    .bannerInfo{
      margin-top: 15px;
    }
    .panel-body p{
      margin-bottom: 2px;
      color: #575757;
    }
    .panel-body{
      padding: 5px;
      padding-left: 15px;
    }
    .tab-content form{
      margin-top: 10px;
    }
    .panel-default{
      margin-bottom: 10px;
    }
    .phoneNo{
        width: 170px;
        height: 30px;
        background-color: #fff;
        padding: 5px 0px 5px 0px; 
        margin: 10px 20px 10px 15px;
        border-radius: 5px;
        color: #ff6c00;
        font-weight: ;
      }
      .shop-button-continue{
        padding-right: 5px;
      }
      .shop-button-place{
        padding-left: 5px;
      }
      .continue{
        border-radius: 0px;
        background-color: #1c1c1c;
        border-width: 0px;
        margin-top: 10px;
        width: 100%;
        padding-top: 15px;
        padding-bottom: 15px;
        font-size: 12px;
      }
      .place-order{
        border-radius: 0px;
        background-color: #1c1c1c;
        border-width: 0px;
        margin-top: 10px;
        width: 100%;
        padding-top: 15px;
        padding-bottom: 15px;
        font-size: 12px;
      }
      .continue:hover{
        background-color: #337ab7;
      }
      .place-order:hover{
        background-color: #ff6c00;
      }
  </style>
</head>
<body style="overflow-x:hidden">

{% if messages %}
    <div id="message">
{% for message in messages %}

   <h3> {{ message }}</h3>
{% endfor %}
    </div>
{% endif %}

  <section>
    {% include 'navbar1.html' %}
    <div class="container">
      <div class="row cart-display">
        <div class="col-sm-8">
          <div class="cont shadow">
            <div class="content-header">Admin Price Changer </div>
            {% for item in details %}
                              <div class="cart-item">
                                <div class="row">
                                  <div class="col-sm-3">
                                    <img src="{{ MEDIA_URL }}{{ item.banner.bannerimage }}" class="img-thumbnail" alt="Sample image" width="250" height="180">
                                  </div>
                                  <div class="col-sm-6">
                                    <h4>{{item.banner.banner_landmark}}</h4>
                                    <p>ID: {{item.banner.id}}</p>
                                    <p>Type: {{item.banner.banner_type}}</p>
                                    <p>Size: {{item.banner.getSize}}</p>
                                  </div>
                                 <p class="pole-price">
                                <span>
                                  <button type="button" class="btn btn-primary pull-right" data-toggle="modal" data-target="#changeIndividualPrice" id= "{{item.banner.id}}" style="margin-left: 5px; " >Change Price</button>  
                                 <script type="text/javascript">
                                   $(document).ready(function(){

                                      $('#{{item.banner.id}}').click(function(){
                                          $('#formIDIndi').val(this.id)
                                          initDateRangePicker({{item.active_booking_details|safe}})
                                      })


                                   })
                                 </script>
                                </span></p>
                                </div>
                              </div>
                              <HR />
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    

    <!-- price change modal -->

        <div id="changeIndividualPrice" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h2 class="modal-title">Change Price</h2>
          </div>
          <div class="modal-body">
            <form  id = "formIndi" method = post action = "{% url 'add_new_price_indi' %}">
            {% csrf_token %}
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" name="daterangeIndi">
                  <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                </div>
              </div>

              <div class="form-group">
                <input type="text" class="form-control" id="newPrice" placeholder="New Price" name = "price">
              </div>
              <input type = "hidden" value="" id = "formIDIndi" name = "boardID">
              <input type = "hidden" value="" id = "startDateFormIndi"  name = "dateStart">
              <input type = "hidden" value="" id = "endDateFormIndi"  name = "dateEnd">
              <input type = "hidden" value="" id = "daysFormIndi"  name = "days" >
            </form>
            <script type="text/javascript">
               var startDateForm;
              var endDateForm;


              var initDateRangePicker = function(invalid_date_set)
                  {
                    invalid_dates = []
                    for(var i = 0; i < invalid_date_set.length; i++)
                    {
                        var cd = moment(invalid_date_set[i].startDate);
                        var ed = moment(invalid_date_set[i].endDate);
                        while(cd.format('YYYY-MM-DD') <= ed.format('YYYY-MM-DD'))
                        {
                            invalid_dates.push(cd.format('YYYY-MM-DD'))
                            cd.add(1, 'days')
                        }
                    }

                    console.log(invalid_date_set)
                    $('input[name="daterangeIndi"]').daterangepicker({
                                            minDate: moment(),
                                            format: 'DD/MM/YYYY',
                                            seperator: 'To',
                                            isInvalidDate: function(date)
                                            {
                                                

                                                if (invalid_dates.indexOf(date.format('YYYY-MM-DD'))!==-1)
                                                {
                                                    return true; 
                                                }
                                                else
                                                {
                                                    return false; 
                                                }
                                            },
                                        },
                                        function(start, end){
                                            console.log("call back");
                                            startDateForm = start;
                                            endDateForm = end;
                                            var diff = end.diff(start, 'days')
                                            $('#startDateFormIndi').val(start.format('YYYY-MM-DD'));
                                            $('#endDateFormIndi').val(end.format('YYYY-MM-DD'));
                                            $('#daysFormIndi').val(diff);
                                            console.log(diff)
                                        });
                  }

             
            </script>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal" data-toggle="modal" data-target="#confirmation">Change Price</button>
          </div>
        </div>

      </div>
    </div>
<div id="confirmation" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
          
          <div class="modal-body">
            <p>Confirm change in price?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" data-dismiss="modal" id = "priceChangeSubmit">OK</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
          </div>
        </div>

      </div>
    </div>
<script type="text/javascript">
  $('#priceChangeSubmit').click(function(){
    $('#formIndi').submit()
  })
</script>



  </section>
</body>



<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />

</html>